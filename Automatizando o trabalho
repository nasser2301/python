from time import sleep as sl
from selenium import webdriver
import pyautogui
from twilio.rest import Client

account_sid = 'ACXXXXXXXXXXXXX'
auth_token = 'XXXXXXXXXXXXXXXXX'

def click(a, b):
    pyautogui.moveTo(a, b)
    pyautogui.mouseDown()
    pyautogui.click()


def mensagem(txt):
    client = Client(account_sid, auth_token)

    message = client.messages.create(
        from_='whatsapp:+14XXXXXXXX',
        body=f'{txt}',
        to='whatsapp:+55XXXXXXXXXXX'
    )



web = webdriver.Chrome()
web.get('url_da_ferramenta')
sl(3)
pyautogui.write('login')
pyautogui.press('tab')
pyautogui.write('senha')
pyautogui.press('enter')
sl(3)
web.find_element_by_xpath('//*[@id="Logo"]').click()
sl(1)
web.find_element_by_xpath('//*[@id="ToolBar"]/li[1]').click()
sl(3)
c = 0
while True:
    c += 1
    sl(3)
    t = web.find_element_by_xpath('//*[@id="AppWrapper"]')
    te = t.text

    if c == 1:
        sl(5)
        pyautogui.hotkey('winleft', 'd')

    if 'Suporte' in te and 'Admin OTRS' in te:
        mensagem('Chamado aberto e não capturado na fila!')
        sl(30)

    elif 'Suporte' in te:
        mensagem('Chamado já foi capturado e está em atendimento!')
        sl(180)
    else:
        mensagem('Sem chamados abertos na fila!')
        sl(320)
